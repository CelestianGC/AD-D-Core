<?xml version="1.0" encoding="iso-8859-1"?>

<!-- 
  Please see the license.html file included with this distribution for 
  attribution and copyright information.
-->

<root>
	<windowclass name="npc" >
		<frame>recordsheet</frame>
		<placement>
			<size width="480" height="550" />
		</placement>
		<sizelimits>
			<minimum width="480" height="400" />
			<dynamic />
		</sizelimits>
		<minimize>minimized_npc</minimize>
		<tooltip field="name" />
		<nodelete />
		<script file="campaign/scripts/npc.lua" />
		<sheetdata>
			<sub_record_header name="header">
				<class>npc_header</class>
			</sub_record_header>
			<frame_record_content_tabbed name="contentframe" />
      <!-- this is so some parts of the bits we include from character sheets -->
      <!-- do not complain, that's why invisible. Revisit and remove/fix? test subwindow_record instead -->
      <!-- --celestian -->
      <anchor_title_charsheet name="contentanchor" />
      <stringu name="name">
				<invisible />
				<anchored to="contentanchor" position="insidetop" offset="0,0" height="0" />
			</stringu>
            <!-- --celestian -->

			<subwindow_record name="main_creature">
				<class>npc_combat</class>
			</subwindow_record>
            
			<ft_record name="text">
				<anchored to="contentframe" position="over" />
				<invisible />
			</ft_record>
            
			<sub_npcsheet name="combat">
				<class>charsheet_combat</class>
			</sub_npcsheet>

			<sub_npcsheet name="skills">
				<class>charsheet_skills</class>
			</sub_npcsheet>

			<sub_npcsheet name="inventory">
				<class>charsheet_inventory</class>
			</sub_npcsheet>

			<scrollbar_record>
				<target>main_creature</target>
			</scrollbar_record>
			<scrollbar_record>
				<target>combat</target>
			</scrollbar_record>
			<scrollbar_record>
				<target>skills</target>
			</scrollbar_record>
			<scrollbar_record>
				<target>inventory</target>
			</scrollbar_record>
			<scrollbar_record>
				<target>text</target>
			</scrollbar_record>

			<tabs_recordsheet>
				<tab>
					<icon>tab_main</icon>
					<subwindow>main_creature</subwindow>
				</tab>
				<tab>
					<icon>tab_skills</icon>
					<subwindow>skills</subwindow>
				</tab>
				<tab>
					<icon>tab_inventory</icon>
					<subwindow>inventory</subwindow>
				</tab>
				<tab>
					<icon>tab_details</icon>
					<subwindow>text</subwindow>
				</tab>
                <tab>
                    <icon>tab_actions</icon>
                    <subwindow>combat</subwindow>
                </tab>
			</tabs_recordsheet>
			
			<resize_recordsheet />
			<close_recordsheet />
		</sheetdata>
	</windowclass>

	<windowclass name="npc_header" merge="join">
		<margins control="0,0,0,2" />
	</windowclass>
	
	<windowclass name="npc_combat">
		<margins control="0,0,0,2" />
		<script file="campaign/scripts/npc_main.lua" />
        
		<sheetdata>
			<anchor_column name="columnanchor" />
			
			<label_column name="size_label">
				<static textres="npc_label_size" />
			</label_column>
			<string_columnh name="size">
				<script>
					function onValueChanged()
						window.onSummaryChanged();
					end
				</script>
			</string_columnh>
			
			<label_column name="type_label">
				<static textres="npc_label_type" />
			</label_column>
			<string_columnh name="type">
				<script>
					function onValueChanged()
						window.onSummaryChanged();
					end
				</script>
			</string_columnh>
			
			<label_column name="alignment_label">
				<static textres="npc_label_alignment" />
			</label_column>
			<string_columnh name="alignment">
				<script>
					function onValueChanged()
						window.onSummaryChanged();
					end
				</script>
			</string_columnh>
			
			<label_column name="summary_label">
				<anchored>
					<top relation="relative" />
				</anchored>
				<font>reference-b-large</font>
			</label_column>
			
			<line_column />
			
			<label_column name="ac_label">
				<static textres="armorclass" />
			</label_column>
			<number_column name="ac" />
			
			<string_column_npc_remainder name="actext">
				<anchored to="ac" />
			</string_column_npc_remainder>

			<label_column name="hp_label">
				<static textres="hitpoints" />
			</label_column>
			<number_column name="hp" />
			<string_column_npc_remainder name="hd">
				<anchored to="hp" />
			</string_column_npc_remainder>

			<label_column name="hitdice_label">
				<static textres="npc_label_hitdice" />
			</label_column>
			<string_column_left name="hitDice" >
                <script>
                    function onValueChanged()
                        local node = getDatabaseNode();
                        local nodeNPC = node.getChild("..");
                        CombatManager2.updateNPCSaves(nodeNPC, nodeNPC, true);
                        CombatManager2.updateNPCLevels(nodeNPC, true);
                    end
                </script>
            </string_column_left>
			<string_column_npc_remainder name="hdtext" >
				<anchored to="hitDice" />
			</string_column_npc_remainder>
			
			<label_column name="thaco_label">
				<static textres="npc_label_thaco" />
			</label_column>
			<number_column name="thaco">
                <default>20</default>
            </number_column>

			<label_npc name="speed_label">
				<anchored to="thaco" position="right" offset="10,0"/>
				<static textres="npc_label_speed" />
			</label_npc>
			<string_column_npc_remainder name="speed">
				<anchored to="speed_label" />
			</string_column_npc_remainder>

			<label_column name="numberattacks_label">
				<static textres="npc_label_numberattacks" />
			</label_column>
			<string_columnh name="numberattacks" >
				<anchored width="120">
					<right merge="delete" />
				</anchored>
			</string_columnh>


			<label_npc name="damage_label">
				<anchored to="numberattacks" position="right" offset="10,0" />
				<static textres="npc_label_damage" />
			</label_npc>
			<string_column_npc_remainder name="damage">
				<anchored to="damage_label" />
			</string_column_npc_remainder>

			<label_column name="specialDefense_label">
				<static textres="npc_label_specialDefense" />
			</label_column>
			<string_column name="specialDefense" />

			<label_column name="specialAttacks_label">
				<static textres="npc_label_specialAttacks" />
			</label_column>
			<string_column name="specialAttacks" />

			<label_column name="magicresistance_label">
				<static textres="npc_label_magicresistance" />
			</label_column>
			<string_columnh name="magicresistance" >
				<anchored width="120">
					<right merge="delete" />
				</anchored> 
			</string_columnh>
			<label_npc name="morale_label">
				<static textres="npc_label_morale" />
				<anchored to="magicresistance" position="right" offset="10,0" />
			</label_npc>
			<string_column_npc_remainder name="morale">
							<anchored to="morale_label" />
			</string_column_npc_remainder>

			<label_column name="xp_label">
				<static textres="xp" />
			</label_column>
      
			<number_column name="xp" />
      
			<line_column />
			<number_npc_abilityscore name="strength" source="abilities.strength.base">
				<anchored merge="replace" width="40" height="30">
					<top parent="columnanchor" anchor="bottom" relation="relative" offset="12" />
					<left anchor="center" offset="-202" />
				</anchored>
				<target>strength</target>
			</number_npc_abilityscore>
			<label_npc_abilityscore>
				<anchored to="strength" />
				<static textres="STR" />
			</label_npc_abilityscore>

			<number_npc_abilityscore name="strengthpercent" source="abilities.strength.percentbase">
        <default>0</default>
        <min> 0 </min>
        <max> 100 </max>
				<font>arial-regular-7</font>
        <tooltip textres="npc_label_strengthpercent_tooltip" />
        <anchored merge="replace" to="strength" width="30" height="25">
          <top />
          <left anchor="right" relation="relative" offset="10" />
				</anchored>
				<target>strength</target>
			</number_npc_abilityscore>
			<label_npc_abilityscore>
        <font>arial-regular-7</font>
        <tooltip textres="npc_label_strengthpercent_tooltip" />
				<anchored to="strengthpercent" />
				<static textres="npc_label_strengthpercent" />
			</label_npc_abilityscore>
			
			<number_npc_abilityscore name="dexterity" source="abilities.dexterity.base">
				<anchored merge="replace" to="strength" width="40" height="30">
					<top />
					<left anchor="right" relation="relative" offset="10" />
				</anchored>
				<target>dexterity</target>
			</number_npc_abilityscore>
			<label_npc_abilityscore>
				<anchored to="dexterity" />
				<static textres="DEX" />
			</label_npc_abilityscore>

			<number_npc_abilityscore name="constitution" source="abilities.constitution.base">
				<anchored merge="replace" to="strength" width="40" height="30">
					<top />
					<left anchor="right" relation="relative" offset="10" />
				</anchored>
				<target>constitution</target>
			</number_npc_abilityscore>
			<label_npc_abilityscore>
				<anchored to="constitution" />
				<static textres="CON" />
			</label_npc_abilityscore>

			<number_npc_abilityscore name="intelligence" source="abilities.intelligence.base">
				<anchored merge="replace" to="strength" width="40" height="30">
					<top />
					<left anchor="right" relation="relative" offset="10" />
				</anchored>
				<target>intelligence</target>
			</number_npc_abilityscore>
			<label_npc_abilityscore>
				<anchored to="intelligence" />
				<static textres="INT" />
			</label_npc_abilityscore>

			<number_npc_abilityscore name="wisdom" source="abilities.wisdom.base">
				<anchored merge="replace" to="strength" width="40" height="30">
					<top />
					<left anchor="right" relation="relative" offset="10" />
				</anchored>
				<target>wisdom</target>
			</number_npc_abilityscore>
			<label_npc_abilityscore>
				<anchored to="wisdom" />
				<static textres="WIS" />
			</label_npc_abilityscore>

			<number_npc_abilityscore name="charisma" source="abilities.charisma.base">
				<anchored merge="replace" to="strength" width="40" height="30">
					<top />
					<left anchor="right" relation="relative" offset="10" />
				</anchored>
				<target>charisma</target>
			</number_npc_abilityscore>
			<label_npc_abilityscore>
				<anchored to="charisma" />
				<static textres="CHA" />
			</label_npc_abilityscore>
			
			<line_column />
            
            <!-- saves -->
			<number_npc_savescore name="paralyzation" source="saves.paralyzation.score">
				<anchored merge="replace" width="30" height="30">
					<top parent="columnanchor" anchor="bottom" relation="relative" offset="12" />
					<left anchor="center" offset="-202" />
				</anchored>
				<tooltip textres="save_paralyzation_full" />
				<target>paralyzation</target>
			</number_npc_savescore>
			<label_npc_savescore name="paralyzation_label">
   				<tooltip textres="save_paralyzation_full" />
				<static text="Para" />
				<anchored to="paralyzation"  />
			</label_npc_savescore>
            
			<number_npc_savescore name="poison" source="saves.poison.score">
				<anchored merge="replace" to="paralyzation" width="30" height="30">
					<top />
					<left anchor="right" relation="relative" offset="10" />
				</anchored>
				<tooltip textres="save_poison_full" />
				<target>poison</target>
			</number_npc_savescore>
			<label_npc_savescore name="poison_label">
   				<tooltip textres="save_poison_full" />
				<static text="Poison" />
				<anchored to="poison"  />
			</label_npc_savescore>
            
			<number_npc_savescore name="death" source="saves.death.score">
				<anchored merge="replace" to="poison" width="30" height="30">
					<top />
					<left anchor="right" relation="relative" offset="10" />
				</anchored>
				<tooltip textres="save_death_full" />
				<target>death</target>
			</number_npc_savescore>
			<label_npc_savescore name="death_label">
   				<tooltip textres="save_death_full" />
				<static text="Death" />
				<anchored to="death" />
			</label_npc_savescore>
            
			<number_npc_savescore name="rod" source="saves.rod.score">
				<anchored merge="replace" to="death" width="30" height="30">
					<top />
					<left anchor="right" relation="relative" offset="10" />
				</anchored>
				<tooltip textres="save_rod_full" />
				<target>rod</target>
			</number_npc_savescore>
			<label_npc_savescore name="rod_label">
   				<tooltip textres="save_rod_full" />
				<static text="Rod" />
				<anchored to="rod" />
			</label_npc_savescore>


			<number_npc_savescore name="staff" source="saves.staff.score">
				<anchored merge="replace" to="rod" width="30" height="30">
					<top />
					<left anchor="right" relation="relative" offset="10" />
				</anchored>
				<tooltip textres="save_staff_full" />
				<target>staff</target>
			</number_npc_savescore>
			<label_npc_savescore name="staff_label">
   				<tooltip textres="save_staff_full" />
				<static text="Staff" />
				<anchored to="staff"  />
			</label_npc_savescore>

            <number_npc_savescore name="wand" source="saves.wand.score">
				<anchored merge="replace" to="staff" width="30" height="30">
					<top />
					<left anchor="right" relation="relative" offset="10" />
				</anchored>
				<tooltip textres="save_wand_full" />
				<target>wand</target>
			</number_npc_savescore>
			<label_npc_savescore name="wand_label">
   				<tooltip textres="save_wand_full" />
				<static text="Wand" />
				<anchored to="wand" />
			</label_npc_savescore>

			<number_npc_savescore name="petrification" source="saves.petrification.score">
				<anchored merge="replace" to="wand" width="30" height="30">
					<top />
					<left anchor="right" relation="relative" offset="10" />
				</anchored>
				<tooltip textres="save_petrification_full" />
				<target>petrification</target>
			</number_npc_savescore>
			<label_npc_savescore name="petrification_label">
   				<tooltip textres="save_petrification_full" />
				<static text="Petrify" />
				<anchored to="petrification" />
			</label_npc_savescore>

			<number_npc_savescore name="polymorph" source="saves.polymorph.score">
				<anchored merge="replace" to="petrification" width="30" height="30">
					<top />
					<left anchor="right" relation="relative" offset="10" />
				</anchored>
				<tooltip textres="save_polymorph_full" />
				<target>polymorph</target>
			</number_npc_savescore>
			<label_npc_savescore name="polymorph_label">
   				<tooltip textres="save_polymorph_full" />
				<static text="Poly" />
				<anchored to="polymorph"  />
			</label_npc_savescore>

			<number_npc_savescore name="breath" source="saves.breath.score">
				<anchored merge="replace" to="polymorph" width="30" height="30">
					<top />
					<left anchor="right" relation="relative" offset="10" />
				</anchored>
				<tooltip textres="save_breath_full" />
				<target>breath</target>
			</number_npc_savescore>
			<label_npc_savescore name="breath_label">
   				<tooltip textres="save_breath_full" />
				<static text="Breath" />
				<anchored to="breath"  />
			</label_npc_savescore>

			<number_npc_savescore name="spell" source="saves.spell.score">
				<anchored merge="replace" to="breath" width="30" height="30">
					<top />
					<left anchor="right" relation="relative" offset="10" />
				</anchored>
				<tooltip textres="save_spell_full" />
				<target>spell</target>
			</number_npc_savescore>
			<label_npc_savescore name="spell_label">
   				<tooltip textres="save_spell_full" />
				<static text="Spell" />
				<anchored to="spell"  />
			</label_npc_savescore>
            
			<line_column>
				<anchored>
					<top parent="columnanchor" anchor="bottom" relation="relative" offset="12" />
				</anchored>
			</line_column>
			
            <!-- effects -->
			<header_column name="header_effects">
				<static textres="header_effects" />
				<center />
			</header_column>
			<button_iedit name="effects_iedit">
				<anchored to="header_effects" position="insidetopright" offset="-5,0" />
 				<script>
					function onValueChanged()
						local bEditMode = (getValue() == 1);
						
						window.effects_list_iadd.setVisible(bEditMode);
						window.effects_list.update();
					end
				</script>
			</button_iedit>
			<button_iadd name="effects_list_iadd">
				<anchored to="effects_iedit" position="lefthigh" offset="5,0" />
				<target>effects_list</target>
			</button_iadd>
            
			<list_editor_advanced_effects name="effects_list">
				<datasource>.effectlist</datasource>
				<class>advanced_effects_entry</class>
				<script>
					function addEntry(bFocus)
						local n = getWindowCount();
						
						local w = createWindow();
						return w;
					end
				</script>
			</list_editor_advanced_effects>

			<line_column />

			<label_column name="organization_label">
				<static textres="npc_label_organization" />
			</label_column>
			<string_column name="organization" />

			<label_column name="diet_label">
				<static textres="npc_label_diet" />
			</label_column>
			<string_columnh name="diet" >
				<anchored width="120">
					<right merge="delete" />
				</anchored>
			</string_columnh>

			<label_npc name="frequency_label">
				<static textres="npc_label_frequency" />
				<anchored to="diet" position="right" offset="10,0" />
			</label_npc>
			<string_column_npc_remainder name="frequency">
							<anchored to="frequency_label" />
			</string_column_npc_remainder>

			<label_column name="activity_label">
				<static textres="npc_label_activity" />
			</label_column>
			<string_columnh name="activity" >
				<anchored width="120">
					<right merge="delete" />
				</anchored>
			</string_columnh>

			<label_npc name="climate_label">
				<static textres="npc_label_climate" />
				<anchored to="activity" position="right" offset="10,0" />
			</label_npc>
			<string_column_npc_remainder name="climate">
							<anchored to="climate_label" />
			</string_column_npc_remainder>

			
			<label_column name="numberappearing_label">
				<static textres="npc_label_numberappearing" />
			</label_column>
			<string_column name="numberappearing" />

			<label_column name="intelligence_label">
				<static textres="npc_label_intelligence" />
			</label_column>
			<string_column name="intelligence_text" />

			<label_column name="treasure_label">
				<static textres="npc_label_treasure" />
			</label_column>
			<string_column name="treasure" />


      <line_column />
            <!-- end effects -->
            
			<label_column name="savingthrows_label">
				<static textres="npc_label_savingthrows" />
			</label_column>
			<string_columnh name="savingthrows" />
			
			<label_column name="skills_label">
				<static textres="npc_label_skills" />
			</label_column>
			<string_columnh name="skills" >
				<script file="campaign/scripts/npc_skill.lua" />
			</string_columnh>
			
			<label_column name="damagevulnerabilities_label">
				<static textres="npc_label_damagevulnerabilities" />
			</label_column>
			<string_columnh_npc_specialdef name="damagevulnerabilities" />
			
			<label_column name="damageresistances_label">
				<static textres="npc_label_damageresistances" />
			</label_column>
			<string_columnh_npc_specialdef name="damageresistances" />
			
			<label_column name="damageimmunities_label">
				<static textres="npc_label_damageimmunities" />
			</label_column>
			<string_columnh_npc_specialdef name="damageimmunities" />
			
			<label_column name="conditionimmunities_label">
				<static textres="npc_label_conditionimmunities" />
			</label_column>
			<string_columnh_npc_specialdef name="conditionimmunities" />
						
			<label_column name="senses_label">
				<static textres="npc_label_senses" />
			</label_column>
			<string_columnh name="senses" />
			
			<label_column name="languages_label">
				<static textres="npc_label_languages" />
			</label_column>
			<string_columnh name="languages" />
			
      <label_column name="challenge_label">
				<static textres="npc_label_challenge" />
        <!-- hide CR, not used in AD&D --celestian -->
        <invisible />
			</label_column>
      
			<string_columnh name="cr" >
				<anchored width="20">
        <right merge="delete" />
				</anchored>
        <!-- hide CR, not used in AD&D --celestian -->
        <invisible />
			</string_columnh>

      <label_column name="clone_to_character_label">
        <static textres="npc_label_clone_to_pc" />
      </label_column>
 			<buttoncontrol name="clone_to_character">
				<anchored to="clone_to_character_label" position="righthigh" offset="10,0" width="20" height="20"/>
        <icon normal="button_expand" pressed="button_dialog_ok" />
				<script>
					function onButtonPress()
						if User.isHost() then
              local node = window.getDatabaseNode();
              local nodeTarget = ConvertManagerADND.convertToPC(node);
              local w = Interface.openWindow("charsheet", nodeTarget.getNodeName());
              if w and w.name then
                w.name.setFocus();
              end
            end
					end
				</script>
			</buttoncontrol>

      
      <!-- 			<label_column name="effect_combat_label">
				<static textres="npc_label_effects" />
                <tooltip textres="npc_label_effects_tooltip" />
                </label_column>
			<string_columnh name="effect_combat">
                <tooltip textres="npc_label_effects_tooltip" />
            </string_columnh>
 -->			
			
<!-- 			<header_column name="header_actions">
				<static textres="npc_header_actions" />
			</header_column>
			<button_iedit name="actions_iedit">
				<anchored to="header_actions" position="righthigh" offset="-20,0" />
				<target>actions</target>
			</button_iedit>
			<button_iadd name="actions_iadd">
				<anchored to="actions_iedit" position="lefthigh" offset="5,0" />
				<target>actions</target>
			</button_iadd>
			<list_npcactions name="actions">
				<datasource>.actions</datasource>
				<class>npc_power</class>
			</list_npcactions>

			<header_column name="header_traits">
				<static textres="npc_header_traits"/>
			</header_column>
			<button_iedit name="traits_iedit">
				<anchored to="header_traits" position="righthigh" offset="-20,0" />
				<target>traits</target>
			</button_iedit>
			<button_iadd name="traits_iadd">
				<anchored to="traits_iedit" position="lefthigh" offset="5,0" />
				<target>traits</target>
			</button_iadd>
			<list_npcactions name="traits">
				<datasource>.traits</datasource>
				<class>npc_power</class>
			</list_npcactions>

			<header_column name="header_reactions">
				<static textres="npc_header_reactions" />
			</header_column>
			<button_iedit name="reactions_iedit">
				<anchored to="header_reactions" position="righthigh" offset="-20,0" />
				<target>reactions</target>
			</button_iedit>
			<button_iadd name="reactions_iadd">
				<anchored to="reactions_iedit" position="lefthigh" offset="5,0" />
				<target>reactions</target>
			</button_iadd>
			<list_npcactions name="reactions">
				<datasource>.reactions</datasource>
				<class>npc_power</class>
			</list_npcactions>

			<header_column name="header_legendaryactions">
				<static textres="npc_header_legendaryactions" />
			</header_column>
			<button_iedit name="legendaryactions_iedit">
				<anchored to="header_legendaryactions" position="righthigh" offset="-20,0" />
				<target>legendaryactions</target>
			</button_iedit>
			<button_iadd name="legendaryactions_iadd">
				<anchored to="legendaryactions_iedit" position="lefthigh" offset="5,0" />
				<target>legendaryactions</target>
			</button_iadd>
			<list_npcactions name="legendaryactions">
				<datasource>.legendaryactions</datasource>
				<class>npc_power</class>
			</list_npcactions>

			<header_column name="header_lairactions">
				<static textres="npc_header_lairactions" />
			</header_column>
			<button_iedit name="lairactions_iedit">
				<anchored to="header_lairactions" position="righthigh" offset="-20,0" />
				<target>lairactions</target>
			</button_iedit>
			<button_iadd name="lairactions_iadd">
				<anchored to="lairactions_iedit" position="lefthigh" offset="5,0" />
				<target>lairactions</target>
			</button_iadd>
			<list_npcactions name="lairactions">
				<datasource>.lairactions</datasource>
				<class>npc_power</class>
			</list_npcactions>

			<header_column name="header_innatespells">
				<static textres="npc_header_innatespells" />
				<script>
					function onDrop(x, y, draginfo)
						if draginfo.isType("shortcut") then
							local sClass = draginfo.getShortcutData();
							local nodeSource = draginfo.getDatabaseNode();
							
							if sClass == "reference_spell" or sClass == "power" then
								window.addSpellDrop(nodeSource, true);
								return true;
							end
						end
					end
				</script>
			</header_column>
			<button_iedit name="innatespells_iedit">
				<anchored to="header_innatespells" position="righthigh" offset="-20,0" />
				<target>innatespells</target>
			</button_iedit>
			<button_iadd name="innatespells_iadd">
				<anchored to="innatespells_iedit" position="lefthigh" offset="5,0" />
				<target>innatespells</target>
			</button_iadd>
			<list_npcactions name="innatespells">
				<datasource>.innatespells</datasource>
				<class>npc_power</class>
				<script>
					function onDrop(x, y, draginfo)
						if draginfo.isType("shortcut") then
							local sClass = draginfo.getShortcutData();
							local nodeSource = draginfo.getDatabaseNode();
							
							if sClass == "reference_spell" or sClass == "power" then
								window.addSpellDrop(nodeSource, true);
								return true;
							end
						end
					end
				</script>
			</list_npcactions>

			<header_column name="header_spells">
				<static textres="npc_header_spells" />
			</header_column>
			<button_iedit name="spells_iedit">
				<anchored to="header_spells" position="righthigh" offset="-20,0" />
				<target>spells</target>
			</button_iedit>
			<button_iadd name="spells_iadd">
				<anchored to="spells_iedit" position="lefthigh" offset="5,0" />
				<target>spells</target>
			</button_iadd>
			<list_npcactions name="spells">
				<datasource>.spells</datasource>
				<class>npc_power</class>
			</list_npcactions>
 -->		</sheetdata>
	</windowclass>

	<windowclass name="npc_power">
		<margins control="0,0,0,2" />
		<sheetdata>
			<genericcontrol name="rightanchor">
				<anchored height="0" width="0">
					<top />
					<right />
				</anchored>
			</genericcontrol>
			<button_idelete name="idelete">
				<anchored>
					<top offset="2" />
					<right parent="rightanchor" anchor="left" relation="relative" offset="-5" />
				</anchored>
			</button_idelete>

			<stringfield name="name">
				<anchored position="insidetopleft" offset="5,2">
					<right parent="rightanchor" anchor="left" relation="relative" offset="-5" />
				</anchored>
				<frame name="rowshade" offset="5,2,5,2" />
				<font>sheetlabel</font>
				<multilinespacing>20</multilinespacing>
				<empty textres="npc_empty_powername" />
			</stringfield>
			
			<basicstring name="desc">
				<anchored to="name" position="belowleft" offset="0,5">
					<right parent="" offset="-5" />
				</anchored>
				<multilinespacing>20</multilinespacing>
				<script file="campaign/scripts/string_powerdesc.lua" />
			</basicstring>
		</sheetdata>
	</windowclass>

	<windowclass name="npc_import_window">
    <margins control="2,2,2,2" />
		<frame>charsheethelper</frame>
		<placement>
			<size width="320" height="300" />
		</placement>
		<sizelimits>
			<minimum width="220" height="300" />
			<dynamic />
		</sizelimits>
    <!-- <script>
      function onInit()
        contents.subwindow.tableimporttext.setFocus();
      end
    </script> -->
		<sheetdata>
      <windowtitlebar name="title">
          <prefix>npc_import_window_title</prefix>
          <resource>npc_import_window_title</resource>
      </windowtitlebar>
      <anchor_title_charsheethelper name="contentanchor" />
			<anchor_left />
      <anchor_right />
      <label_charframetop>
        <anchored>
          <top parent="contentanchor" anchor="bottom" relation="relative" offset="5" />
          <left parent="leftanchor" anchor="right" relation="relative" offset="35" />
          <right offset="-45"/>
        </anchored>
        <multilinespacing>20</multilinespacing>
        <static textres="npc_import_text_helptext" />
			</label_charframetop>
      <label_charframetop name="importtabletitle">
				<anchored height="20">
					<top parent="contentanchor" anchor="bottom" relation="relative" offset="5" />
					<left offset="35"/>
					<right offset="-45"/>
				</anchored>
				<static textres="npc_import_text_title" />
			</label_charframetop>
            
			<subwindow name="contents">
				<anchored>
					<top parent="contentanchor" anchor="bottom" relation="relative" offset="0" />
					<bottom offset="-40" />
					<left offset="0" />
					<right offset="-15" />
				</anchored>
				<class>npc_import_contents</class>
				<activate />
				<fastinit />
			</subwindow>
      <scrollbar_charcontents />
            <!-- -->
			<button_text_sm>
      <anchored to="contents" position="belowleft" offset="0,0"  height="20" width="70">
        <left parent="title" anchor="right" offset="-100" />
      </anchored>
      <script>
        function onButtonPress()
          window.contents.subwindow.importTextAsNPC();
          window.contents.subwindow.npcimporttext.setValue("");
          window.close();
        end
      </script>
				<state textres="npc_import_text_button" />
			</button_text_sm>
      <close>
        <anchored>
            <top offset="24" />
            <right offset="0" />
        </anchored>
      </close>
      <resize>
      <anchored>
        <right offset="-12" />
        <bottom offset="-14" />
      </anchored>
      </resize>
		</sheetdata>
	</windowclass>
	<windowclass name="npc_import_contents">
    <margins control="15,15,15,15" />
    <script file="campaign/scripts/npc_import.lua" />
		<sheetdata>
			<anchor_column name="columnanchor" />
			<anchor_left />
      <anchor_right />
      <stringu name="npcimporttext">
        <anchored>
            <top parent="columnanchor" anchor="bottom" relation="relative" offset="5" />
            <left offset="15" />
            <right offset="-10" />
        </anchored>
        <multilinespacing>20</multilinespacing>
      </stringu>
    </sheetdata>
	</windowclass>
  
</root>