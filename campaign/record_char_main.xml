<?xml version="1.0" encoding="iso-8859-1"?>

<!-- 
  Please see the license.html file included with this distribution for 
  attribution and copyright information.
-->

<root>
	<windowclass name="charsheet_main" >
		<script>
			function onDrop(x, y, draginfo)
				if draginfo.isType("shortcut") then
					local sClass, sRecord = draginfo.getShortcutData();

					if StringManager.contains({"reference_class", "reference_race", "reference_subrace", "reference_background"}, sClass) then
						CharManager.addInfoDB(getDatabaseNode(), sClass, sRecord);
						return true;
					end
				end
			end
			
			function onHealthChanged()
				local sColor = ActorManager2.getWoundColor("pc", getDatabaseNode());
				wounds.setColor(sColor);
			end
		</script>
		<sheetdata>
			<number_charlevel name="level">
				<bounds>0,0,0,0</bounds>
				<invisible />
			</number_charlevel>

			<label_charframetop name="classleveltitle">
				<anchored height="20">
					<top offset="10" />
					<left offset="15" />
					<right offset="-260" />
				</anchored>
				<icons>char_class</icons>
				<static textres="char_label_classlevel" />
			</label_charframetop>
			<stringc_charclasslevel name="classlevel">
				<anchored to="classleveltitle" position="insidetopleft" offset="-5,25">
					<right offset="-10" />
				</anchored>
			</stringc_charclasslevel>
			<button_charclasslevel name="button_classlevel">
				<anchored to="classlevel" position="righthigh" offset="0,0" />
			</button_charclasslevel>

			<label_charframetop name="backgroundtitle">
				<anchored to="classleveltitle" position="righthigh" offset="35,0" height="20" width="130">
                </anchored>
				<icons>char_background</icons>
				<static textres="char_label_background" />
			</label_charframetop>
			<linkfield name="backgroundlink">
				<anchored to="backgroundtitle" position="belowright" offset="-10,5" width="20" height="20" />
				<description field="background" />
				<closetoggle />
				<invisible />
				<script>
					function onInit()
						onValueChanged();
					end
					function onValueChanged()
						if isEmpty() then
							setVisible(false);
						else
							setVisible(true);
						end
					end
				</script>
			</linkfield>
			<stringu name="background">
				<anchored to="backgroundtitle" position="belowleft" offset="-5,5" height="20">
					<right parent="backgroundlink" anchor="left" offset="-5" />
				</anchored>
			</stringu>


<!-- Ability Scores -->
			<label_charframetop name="statstitle">
				<anchored height="20" width="303">
					<top offset="70" />
					<left offset="15" />
				</anchored>
				<static textres="char_label_stats" />
			</label_charframetop>
			
			<!-- Ability STR -->
			
			<number_charabilityscore2 name="strength" source="abilities.strength.score" >
				<tooltip textres="char_tooltip_strength" />
				<anchored offset="-10,30"  width="45" height="45"/>
				<target>strength</target>
			</number_charabilityscore2>
 			<label_abilityscore>
				<anchored to="strength" />
				<static textres="STR" />
			</label_abilityscore>

			<ability_fields_container name="strdetailframe">
				<anchored to="strength" />
			</ability_fields_container>			
			
            <percentile_abilityfield name="strength_percent" source="abilities.strength.percent">
   				<center />
                <min> 0 </min>
                <max> 100 </max>
				<anchored to="strdetailframe" position="insidetopleft" offset="5,6" width="30" height="30"/>
				<labelres>char_label_ability_percent</labelres>
				<tooltip textres="char_tooltip_percentile" />
				<script>
					function onValueChanged()
                        local rActor = ActorManager.getActor("pc", window.getDatabaseNode());
                        local sActorType, nodeActor = ActorManager.getTypeAndNode(rActor);
                        local nScore = DB.getValue(nodeActor, "abilities.strength.score", 0);
                        AbilityScores.updateStrength(nodeActor,nScore);
					end
				</script>
			</percentile_abilityfield>
 			<label_ability_fields>
				<anchored to="strength_percent" />
   				<tooltip textres="char_tooltip_percentile" />
				<static textres="char_label_ability_percent" />
			</label_ability_fields>

			<number_abilityfield name="strength_hitadj" source="abilities.strength.hitadj">
				<anchored to="strength_percent" />
				<tooltip textres="char_tooltip_strength_hitadj" />
				<labelres>char_label_strength_hitadj</labelres>
			</number_abilityfield>
  			<label_ability_fields>
				<anchored to="strength_hitadj" />
   				<tooltip textres="char_tooltip_strength_hitadj" />
				<static textres="char_label_strength_hitadj" />
			</label_ability_fields>
			
			<number_abilityfield name="strength_dmgadj" source="abilities.strength.dmgadj">
				<anchored to="strength_hitadj" />
				<tooltip textres="char_tooltip_strength_dmgadj" />
				<labelres>char_label_strength_dmgadj</labelres>
			</number_abilityfield>
 			<label_ability_fields>
				<anchored to="strength_dmgadj" />
   				<tooltip textres="char_tooltip_strength_dmgadj" />
				<static textres="char_label_strength_dmgadj" />
			</label_ability_fields>

			<number_abilityfield name="strength_weightallow" source="abilities.strength.weightallow">
				<anchored to="strength_dmgadj" />
				<tooltip textres="char_tooltip_strength_weightallow" />
				<labelres>char_label_strength_weightallow</labelres>
			</number_abilityfield>
 			<label_ability_fields>
				<anchored to="strength_weightallow" />
   				<tooltip textres="char_tooltip_strength_weightallow" />
				<static textres="char_label_strength_weightallow" />
			</label_ability_fields>

			<number_abilityfield name="strength_maxpress" source="abilities.strength.maxpress">
				<anchored to="strength_weightallow"/>
				<tooltip textres="char_tooltip_strength_maxpress" />
				<labelres>char_label_strength_maxpress</labelres>
			</number_abilityfield>
 			<label_ability_fields>
				<anchored to="strength_maxpress" />
   				<tooltip textres="char_tooltip_strength_maxpress" />
				<static textres="char_label_strength_maxpress" />
			</label_ability_fields>

			<string_abilityfield name="strength_opendoors" source="abilities.strength.opendoors">
				<anchored to="strength_maxpress"/>
				<tooltip textres="char_tooltip_strength_opendoors" />
				<labelres>char_label_strength_opendoors</labelres>
			</string_abilityfield>
 			<label_ability_fields>
				<anchored to="strength_opendoors" />
   				<tooltip textres="char_tooltip_strength_opendoors" />
				<static textres="char_label_strength_opendoors" />
			</label_ability_fields>

			<number_abilityfield name="strength_bendbars" source="abilities.strength.bendbars">
				<anchored to="strength_opendoors"/>
				<tooltip textres="char_tooltip_strength_bendbars" />
				<labelres>char_label_strength_bendbars</labelres>
			</number_abilityfield>
 			<label_ability_fields>
				<anchored to="strength_bendbars" />
   				<tooltip textres="char_tooltip_strength_bendbars" />
				<static textres="char_label_strength_bendbars" />
			</label_ability_fields>

 			<!-- Ability DEX -->

			<number_charabilityscore2 name="dexterity" source="abilities.dexterity.score">
				<tooltip textres="char_tooltip_dexterity" />
				<anchored to="strength" position="below" offset="0,5" height="45"/>
				<target>dexterity</target>
			</number_charabilityscore2>
 			<label_abilityscore>
				<anchored to="dexterity" />
				<static textres="DEX" />
			</label_abilityscore>
			
			<ability_fields_container name="dexdetailframe">
				<anchored to="dexterity" />
			</ability_fields_container>			

            <percentile_abilityfield name="dexterity_percent" source="abilities.dexterity.percent">
   				<center />
                <min> 0 </min>
                <max> 100 </max>
				<anchored to="dexdetailframe" position="insidetopleft" offset="5,6" width="30" height="30"/>
				<labelres>char_label_ability_percent</labelres>
				<tooltip textres="char_tooltip_percentile" />
				<script>
					function onValueChanged()
                        local rActor = ActorManager.getActor("pc", window.getDatabaseNode());
                        local sActorType, nodeActor = ActorManager.getTypeAndNode(rActor);
                        local nScore = DB.getValue(nodeActor, "abilities.dexterity.score", 0);
                        AbilityScores.updateDexterity(nodeActor,nScore);
					end
				</script>
			</percentile_abilityfield>
 			<label_ability_fields>
				<anchored to="dexterity_percent" />
   				<tooltip textres="char_tooltip_percentile" />
				<static textres="char_label_ability_percent" />
			</label_ability_fields>

			<!-- Dex ability fields -->
			<number_abilityfield name="dexterity_reactionadj" source="abilities.dexterity.reactionadj">
				<anchored to="dexterity_percent"  width="80"/>
				<tooltip textres="char_tooltip_dexterity_reactionadj" />
				<labelres>char_label_dexterity_reactionadj</labelres>
			</number_abilityfield>
  			<label_ability_fields>
				<anchored to="dexterity_reactionadj" />
   				<tooltip textres="char_tooltip_dexterity_reactionadj" />
				<static textres="char_label_dexterity_reactionadj" />
			</label_ability_fields>

			<number_abilityfield name="dexterity_missileadj" source="abilities.dexterity.hitadj">
				<anchored to="dexterity_reactionadj" width="80" />
				<tooltip textres="char_tooltip_dexterity_missileadj"  />
				<labelres>char_label_dexterity_missileadj</labelres>
			</number_abilityfield>
  			<label_ability_fields>
				<anchored to="dexterity_missileadj" />
   				<tooltip textres="char_tooltip_dexterity_missileadj" />
				<static textres="char_label_dexterity_missileadj" />
			</label_ability_fields>
			
			<number_abilityfield name="dexterity_defenseadj" source="abilities.dexterity.defenseadj">
				<anchored to="dexterity_missileadj" width="80" />
				<tooltip textres="char_tooltip_dexterity_defenseadj" />
				<labelres>char_label_dexterity_defenseadj</labelres>
			</number_abilityfield>
  			<label_ability_fields>
				<anchored to="dexterity_defenseadj" />
   				<tooltip textres="char_tooltip_dexterity_defenseadj" />
				<static textres="char_label_dexterity_defenseadj" />
			</label_ability_fields>
			
			<!-- Ability Con -->
			<number_charabilityscore2 name="constitution" source="abilities.constitution.score">
				<tooltip textres="char_tooltip_constitution" />
				<anchored to="dexterity" position="below" offset="0,5"  height="45"/>
				<target>constitution</target>
			</number_charabilityscore2>
 			<label_abilityscore>
				<anchored to="constitution" />
				<static textres="CON" />
			</label_abilityscore>
			
			<ability_fields_container name="condetailframe">
				<anchored to="constitution" />
			</ability_fields_container>			
			
            <percentile_abilityfield name="constitution_percent" source="abilities.constitution.percent">
   				<center />
                <min> 0 </min>
                <max> 100 </max>
				<anchored to="condetailframe" position="insidetopleft" offset="5,6" width="30" height="30"/>
				<labelres>char_label_ability_percent</labelres>
				<tooltip textres="char_tooltip_percentile" />
				<script>
					function onValueChanged()
                        local rActor = ActorManager.getActor("pc", window.getDatabaseNode());
                        local sActorType, nodeActor = ActorManager.getTypeAndNode(rActor);
                        local nScore = DB.getValue(nodeActor, "abilities.constitution.score", 0);
                        AbilityScores.updateConstitution(nodeActor,nScore);
					end
				</script>
			</percentile_abilityfield>
 			<label_ability_fields>
				<anchored to="constitution_percent" />
   				<tooltip textres="char_tooltip_percentile" />
				<static textres="char_label_ability_percent" />
			</label_ability_fields>

			<!-- CON ability fields -->
			<string_abilityfield name="constitution_hitpointadj" source="abilities.constitution.hitpointadj">
				<anchored to="constitution_percent" />
				<tooltip textres="char_tooltip_constitution_hitpointadj" />
				<labelres>char_label_constitution_hitpointadj</labelres>
			</string_abilityfield>
   			<label_ability_fields>
				<anchored to="constitution_hitpointadj" />
   				<tooltip textres="char_tooltip_constitution_hitpointadj" />
				<static textres="char_label_constitution_hitpointadj" />
			</label_ability_fields>
			
			<number_abilityfield name="constitution_systemshock" source="abilities.constitution.systemshock">
				<anchored to="constitution_hitpointadj" />
				<tooltip textres="char_tooltip_constitution_systemshock" />
				<labelres>char_label_constitution_systemshock</labelres>
			</number_abilityfield>
   			<label_ability_fields>
				<anchored to="constitution_systemshock" />
   				<tooltip textres="char_tooltip_constitution_systemshock" />
				<static textres="char_label_constitution_systemshock" />
			</label_ability_fields>

			<number_abilityfield name="constitution_resurrectionsurvival" source="abilities.constitution.resurrectionsurvival">
				<anchored to="constitution_systemshock" />
				<tooltip textres="char_tooltip_constitution_resurrectionsurvival" />
				<labelres>char_label_constitution_resurrectionsurvival</labelres>
			</number_abilityfield>
   			<label_ability_fields>
				<anchored to="constitution_resurrectionsurvival" />
   				<tooltip textres="char_tooltip_constitution_resurrectionsurvival" />
				<static textres="char_label_constitution_resurrectionsurvival" />
			</label_ability_fields>

			<number_abilityfield name="constitution_poisonadj" source="abilities.constitution.poisonadj">
				<anchored to="constitution_resurrectionsurvival" />
				<tooltip textres="char_tooltip_constitution_poisonadj" />
				<labelres>char_label_constitution_poisonadj</labelres>
			</number_abilityfield>
   			<label_ability_fields>
				<anchored to="constitution_poisonadj" />
   				<tooltip textres="char_tooltip_constitution_poisonadj" />
				<static textres="char_label_constitution_poisonadj" />
			</label_ability_fields>

			<string_abilityfield name="constitution_regeneration" source="abilities.constitution.regeneration">
				<anchored to="constitution_poisonadj" width="80"/>
				<tooltip textres="char_tooltip_constitution_regeneration" />
				<labelres>char_label_constitution_regeneration</labelres>
			</string_abilityfield>
   			<label_ability_fields>
				<anchored to="constitution_regeneration" />
   				<tooltip textres="char_tooltip_constitution_regeneration" />
				<static textres="char_label_constitution_regeneration" />
			</label_ability_fields>
			
			<!-- Ability INT -->
			<number_charabilityscore2 name="intelligence" source="abilities.intelligence.score">
				<tooltip textres="char_tooltip_intelligence" />
				<anchored to="constitution" position="below" offset="0,5" height="45"/>
				<target>intelligence</target>
			</number_charabilityscore2>
 			<label_abilityscore>
				<anchored to="intelligence" />
				<static textres="INT" />
			</label_abilityscore>
			
			<ability_fields_container name="intdetailframe">
				<anchored to="intelligence" />
			</ability_fields_container>			
			
            <percentile_abilityfield name="intelligence_percent" source="abilities.intelligence.percent">
   				<center />
                <min> 0 </min>
                <max> 100 </max>
				<anchored to="intdetailframe" position="insidetopleft" offset="5,6" width="30" height="30"/>
				<labelres>char_label_ability_percent</labelres>
				<tooltip textres="char_tooltip_percentile" />
				<script>
					function onValueChanged()
                        local rActor = ActorManager.getActor("pc", window.getDatabaseNode());
                        local sActorType, nodeActor = ActorManager.getTypeAndNode(rActor);
                        local nScore = DB.getValue(nodeActor, "abilities.intelligence.score", 0);
                        AbilityScores.updateIntelligence(nodeActor,nScore);
					end
				</script>
			</percentile_abilityfield>
 			<label_ability_fields>
				<anchored to="intelligence_percent" />
   				<tooltip textres="char_tooltip_percentile" />
				<static textres="char_label_ability_percent" />
			</label_ability_fields>

			<!-- INT ability fields -->
			<number_abilityfield name="intelligence_languages" source="abilities.intelligence.languages">
				<anchored to="intelligence_percent"/>
				<tooltip textres="char_tooltip_intelligence_languages" />
				<labelres>char_label_intelligence_languages</labelres>
			</number_abilityfield>
 			<label_ability_fields>
				<anchored to="intelligence_languages" />
   				<tooltip textres="char_tooltip_intelligence_languages" />
				<static textres="char_label_intelligence_languages" />
			</label_ability_fields>

			<number_abilityfield name="intelligence_spelllevel" source="abilities.intelligence.spelllevel">
				<anchored to="intelligence_languages"/>
				<tooltip textres="char_tooltip_intelligence_spelllevel" />
				<labelres>char_label_intelligence_spelllevel</labelres>
			</number_abilityfield>
 			<label_ability_fields>
				<anchored to="intelligence_spelllevel" />
   				<tooltip textres="char_tooltip_intelligence_spelllevel" />
				<static textres="char_label_intelligence_spelllevel" />
			</label_ability_fields>

			<number_abilityfield name="intelligence_learn" source="abilities.intelligence.learn">
				<anchored to="intelligence_spelllevel"/>
				<tooltip textres="char_tooltip_intelligence_learn" />
				<labelres>char_label_intelligence_learn</labelres>
			</number_abilityfield>
 			<label_ability_fields>
				<anchored to="intelligence_learn" />
   				<tooltip textres="char_tooltip_intelligence_learn" />
				<static textres="char_label_intelligence_learn" />
			</label_ability_fields>

			<number_abilityfield name="intelligence_maxlevel" source="abilities.intelligence.maxlevel">
				<anchored to="intelligence_learn"/>
				<tooltip textres="char_tooltip_intelligence_maxlevel" />
				<labelres>char_label_intelligence_maxlevel</labelres>
			</number_abilityfield>
 			<label_ability_fields>
				<anchored to="intelligence_maxlevel" />
   				<tooltip textres="char_tooltip_intelligence_maxlevel" />
				<static textres="char_label_intelligence_maxlevel" />
			</label_ability_fields>

			<string_abilityfield name="intelligence_illusion" source="abilities.intelligence.illusion" >
				<!-- <multilinespacing>20</multilinespacing> -->
				<anchored to="intelligence_maxlevel" width="80"/>
				<tooltip textres="char_tooltip_intelligence_illusion" />
				<labelres>char_label_intelligence_illusion</labelres>
			</string_abilityfield>
 			<label_ability_fields>
				<anchored to="intelligence_illusion" />
   				<tooltip textres="char_tooltip_intelligence_illusion" />
				<static textres="char_label_intelligence_illusion" />
			</label_ability_fields>
			
			
			<!-- Ability WIS -->
			<number_charabilityscore2 name="wisdom" source="abilities.wisdom.score">
				<tooltip textres="char_tooltip_wisdom" />
				<anchored to="intelligence" position="below" offset="0,5" height="45"/>
				<target>wisdom</target>
			</number_charabilityscore2>
 			<label_abilityscore>
				<anchored to="wisdom" />
				<static textres="WIS" />
			</label_abilityscore>
			
			<ability_fields_container name="wisdetailframe">
				<anchored to="wisdom" />
			</ability_fields_container>			
			
            <percentile_abilityfield name="wisdom_percent" source="abilities.wisdom.percent">
   				<center />
                <min> 0 </min>
                <max> 100 </max>
				<anchored to="wisdetailframe" position="insidetopleft" offset="5,6" width="30" height="30"/>
				<labelres>char_label_ability_percent</labelres>
				<tooltip textres="char_tooltip_percentile" />
				<script>
					function onValueChanged()
                        local rActor = ActorManager.getActor("pc", window.getDatabaseNode());
                        local sActorType, nodeActor = ActorManager.getTypeAndNode(rActor);
                        local nScore = DB.getValue(nodeActor, "abilities.wisdom.score", 0);
                        AbilityScores.updateWisdom(nodeActor,nScore);
					end
				</script>
			</percentile_abilityfield>
 			<label_ability_fields>
				<anchored to="wisdom_percent" />
   				<tooltip textres="char_tooltip_percentile" />
				<static textres="char_label_ability_percent" />
			</label_ability_fields>

			<!-- WIS ability fields -->
			<number_abilityfield name="wisdom_magicdefenseadj" source="abilities.wisdom.magicdefenseadj">
				<anchored to="wisdom_percent"/>
				<tooltip textres="char_tooltip_wisdom_magicdefenseadj" />
				<labelres>char_label_wisdom_magicdefenseadj</labelres>
			</number_abilityfield>
 			<label_ability_fields>
				<anchored to="wisdom_magicdefenseadj" />
   				<tooltip textres="char_tooltip_wisdom_magicdefenseadj" />
				<static textres="char_label_wisdom_magicdefenseadj" />
			</label_ability_fields>

			<number_abilityfield name="wisdom_failure" source="abilities.wisdom.failure">
				<anchored to="wisdom_magicdefenseadj"/>
				<tooltip textres="char_tooltip_wisdom_failure" />
				<labelres>char_label_wisdom_failure</labelres>
			</number_abilityfield>
 			<label_ability_fields>
				<anchored to="wisdom_failure" />
   				<tooltip textres="char_tooltip_wisdom_failure" />
				<static textres="char_label_wisdom_failure" />
			</label_ability_fields>
			
			<string_abilityfield name="wisdom_immunity" source="abilities.wisdom.immunity">
				<anchored to="wisdom_failure" width="80"/>
				<tooltip textres="char_tooltip_wisdom_immunity" />
				<labelres>char_label_wisdom_immunity</labelres>
			</string_abilityfield>
 			<label_ability_fields>
				<anchored to="wisdom_immunity" />
   				<tooltip textres="char_tooltip_wisdom_immunity" />
				<static textres="char_label_wisdom_immunity" />
			</label_ability_fields>
			
			<string_abilityfield name="wisdom_spellbonus" source="abilities.wisdom.spellbonus">
				<!-- <multilinespacing>15</multilinespacing> -->
				<anchored to="wisdom_immunity" width="80"/>
				<tooltip textres="char_tooltip_wisdom_spellbonus" />
				<labelres>char_label_wisdom_spellbonus</labelres>
			</string_abilityfield>
 			<label_ability_fields>
				<anchored to="wisdom_spellbonus" />
   				<tooltip textres="char_tooltip_wisdom_spellbonus" />
				<static textres="char_label_wisdom_spellbonus" />
			</label_ability_fields>

			
			<!-- Ability CHR -->
			<number_charabilityscore2 name="charisma" source="abilities.charisma.score">
				<tooltip textres="char_tooltip_charisma" />
				<anchored to="wisdom" position="below" offset="0,5" height="45"/>
				<target>charisma</target>
			</number_charabilityscore2>
 			<label_abilityscore>
				<anchored to="charisma" />
				<static textres="CHR" />
			</label_abilityscore>
			
			<ability_fields_container name="chrdetailframe">
				<anchored to="charisma" />
			</ability_fields_container>			
			
            <percentile_abilityfield name="charisma_percent" source="abilities.charisma.percent">
   				<center />
                <min> 0 </min>
                <max> 100 </max>
				<anchored to="chrdetailframe" position="insidetopleft" offset="5,6" width="30" height="30"/>
				<labelres>char_label_ability_percent</labelres>
				<tooltip textres="char_tooltip_percentile" />
				<script>
					function onValueChanged()
                        local rActor = ActorManager.getActor("pc", window.getDatabaseNode());
                        local sActorType, nodeActor = ActorManager.getTypeAndNode(rActor);
                        local nScore = DB.getValue(nodeActor, "abilities.charisma.score", 0);
                        AbilityScores.updateCharisma(nodeActor,nScore);
					end
				</script>
			</percentile_abilityfield>
 			<label_ability_fields>
				<anchored to="charisma_percent" />
   				<tooltip textres="char_tooltip_percentile" />
				<static textres="char_label_ability_percent" />
			</label_ability_fields>

			<!-- CHR ability fields -->
			<number_abilityfield name="charisma_maxhench" source="abilities.charisma.maxhench">
				<anchored to="charisma_percent" width="80"/>
				<tooltip textres="char_tooltip_charisma_maxhench" />
				<labelres>char_label_charisma_maxhench</labelres>
			</number_abilityfield>
 			<label_ability_fields>
				<anchored to="charisma_maxhench" />
   				<tooltip textres="char_tooltip_charisma_maxhench" />
				<static textres="char_label_charisma_maxhench" />
			</label_ability_fields>

			<number_abilityfield name="charisma_loyalty" source="abilities.charisma.loyalty">
				<anchored to="charisma_maxhench" width="80"/>
				<tooltip textres="char_tooltip_charisma_loyalty" />
				<labelres>char_label_charisma_loyalty</labelres>
			</number_abilityfield>
 			<label_ability_fields>
				<anchored to="charisma_loyalty" />
   				<tooltip textres="char_tooltip_charisma_loyalty" />
				<static textres="char_label_charisma_loyalty" />
			</label_ability_fields>

			<number_abilityfield name="charisma_reaction" source="abilities.charisma.reaction">
				<anchored to="charisma_loyalty" width="80"/>
				<tooltip textres="char_tooltip_charisma_reaction" />
				<labelres>char_label_charisma_reaction</labelres>
			</number_abilityfield>
 			<label_ability_fields>
				<anchored to="charisma_reaction" />
   				<tooltip textres="char_tooltip_charisma_reaction" />
				<static textres="char_label_charisma_reaction" />
			</label_ability_fields>
			<!-- END Ability Scores -->
			
<!-- SAVES -->
			<label_charframetop name="savestitle">
				<anchored to="statstitle" position="right" offset="35,0" width="130"/>
                <static textres="char_label_save" />
			</label_charframetop>

			<number_charasavescore name="save_paralyzation_poison_death" source="saves.save_paralyzation_poison_death.score">
				<anchored to="savestitle" position="insidetopleft" offset="0,30"  width="30"/> 
				<target>save_paralyzation_poison_death</target>
				<modifierfield>saves.save_paralyzation_poison_death.modifier</modifierfield>
			</number_charasavescore>
			<label_savescore name="save_poison_label">
   				<tooltip textres="save_paralyzation_poison_death_full" />
				<anchored to="save_paralyzation_poison_death" />
				<static textres="save_paralyzation_poison_death_wrapped" />
			</label_savescore>
			<number_modifier2 name="save_paralyzation_poison_death_mod" source="saves.save_paralyzation_poison_death.modifier">
   				<tooltip textres="save_tooltip_mod" />
				<anchored to="save_poison_label" position="right" offset="0,0" width="30" />
			</number_modifier2>
			<label_mod_fields>
				<anchored to="save_paralyzation_poison_death_mod" />
   				<tooltip textres="save_tooltip_mod" />
				<static textres="text_MOD" />
			</label_mod_fields>

			<number_charasavescore name="save_rod_staff_wand" source="saves.save_rod_staff_wand.score">
				<anchored to="save_paralyzation_poison_death" />
				<target>save_rod_staff_wand</target>
				<modifierfield>saves.rod_staff_wand.modifier</modifierfield>
			</number_charasavescore>
			<label_savescore name="save_wand_label">
   				<tooltip textres="save_rod_staff_wand_full" />
				<anchored to="save_rod_staff_wand" />
				<static textres="save_rod_staff_wand_wrapped" />
			</label_savescore>
			<number_modifier2 name="save_rod_staff_wand_mod" source="saves.save_rod_staff_wand.modifier">
   				<tooltip textres="save_tooltip_mod" />
				<anchored to="save_wand_label" position="right" offset="0,0" width="30" />
			</number_modifier2>
			<label_mod_fields>
				<anchored to="save_rod_staff_wand_mod" />
   				<tooltip textres="save_tooltip_mod" />
				<static textres="text_MOD" />
			</label_mod_fields>
            
			<number_charasavescore name="save_petrify_polymorph" source="saves.save_petrify_polymorph.score">
				<anchored to="save_rod_staff_wand" />
				<target>save_petrify_polymorph</target>
				<modifierfield>saves.save_petrify_polymorph.modifier</modifierfield>
			</number_charasavescore>
			<label_savescore  name="save_poly_label">
   				<tooltip textres="save_petrify_polymorph_full" />
				<anchored to="save_petrify_polymorph" />
				<static textres="save_petrify_polymorph_wrapped" />
			</label_savescore>
			<number_modifier2 name="save_petrify_polymorph_mod" source="saves.save_petrify_polymorph.modifier">
   				<tooltip textres="save_tooltip_mod" />
				<anchored to="save_poly_label" position="right" offset="0,0" width="30" />
			</number_modifier2>
			<label_mod_fields>
				<anchored to="save_petrify_polymorph_mod" />
   				<tooltip textres="save_tooltip_mod" />
				<static textres="text_MOD" />
			</label_mod_fields>
            
			<number_charasavescore name="save_breath" source="saves.save_breath.score">
				<anchored to="save_petrify_polymorph" />
				<target>save_breath</target>
				<modifierfield>saves.save_breath.modifier</modifierfield>
			</number_charasavescore>
			<label_savescore  name="save_breath_label">
   				<tooltip textres="save_breath_full" />
				<anchored to="save_breath" />
				<static textres="save_breath_wrapped" />
			</label_savescore>
			<number_modifier2 name="save_breath_mod" source="saves.save_breath.modifier">
   				<tooltip textres="save_tooltip_mod" />
				<anchored to="save_breath_label" position="right" offset="0,0" width="30" />
			</number_modifier2>
			<label_mod_fields>
				<anchored to="save_breath_mod" />
   				<tooltip textres="save_tooltip_mod" />
				<static textres="text_MOD" />
			</label_mod_fields>

   			<number_charasavescore name="save_spell" source="saves.save_spell.score">
				<anchored to="save_breath" />
				<target>save_spell</target>
				<modifierfield>saves.save_spell.modifier</modifierfield>
			</number_charasavescore>
			<label_savescore  name="save_spell_label">
   				<tooltip textres="save_spell_full" />
				<anchored to="save_spell" />
				<static textres="save_spell_wrapped" />
			</label_savescore>
			<number_modifier2 name="save_spell_mod" source="saves.save_spell.modifier">
   				<tooltip textres="save_tooltip_mod" />
				<anchored to="save_spell_label" position="right" offset="0,0" width="30" />
			</number_modifier2>
			<label_mod_fields>
				<anchored to="save_spell_mod" />
   				<tooltip textres="save_tooltip_mod" />
				<static textres="text_MOD" />
			</label_mod_fields>
<!-- END SAVES -->

			<!-- THACO/AC/Move -->
 			<label_charframetop name="combattitle" >
  				<anchored height="20" width="250">
					<top anchor="bottom" offset="-110" />
					<left offset="15" />
				</anchored>
				<icons>char_init</icons>
			</label_charframetop>

			
<!-- 			THACO -->
			<basicnumber name="thaco" source="combat.thaco.score">
				<min>-10</min>
				<max>30</max>
				<default>20</default>
				<anchored to="combattitle" width="40" height="30">
					<top anchor="bottom" offset="15" />
					<left anchor="left" offset="20" />
				</anchored>
			</basicnumber>
			<label_charfieldtop>
				<anchored to="thaco" offset="0,15" />
				<static textres="thaco" />
			</label_charfieldtop>
			
			<!-- 	Magnify button -->
			<button_charcombatcalc name="button_combatcalc">
				<anchored to="thaco" position="lefthigh" offset="15,5" />
			</button_charcombatcalc>

			<number_chartotalac name="ac2" source="defenses.ac.total">
				<readonly />
				<anchored to="combattitle" width="30" height="40">
					<top anchor="bottom" offset="10" />
					<left anchor="center" offset="-55" />
				</anchored>
				<frame name="acicon" offset="2,0,2,4" />
			</number_chartotalac>
			<button_armorprof name="armorprof" source="defenses.ac.prof">
				<anchored to="ac2" />
			</button_armorprof>
			<label_charfieldtop>
				<anchored to="ac2" offset="0,10" />
				<static textres="ac" />
			</label_charfieldtop>
			
			<number_charinit name="initiative" source="initiative.total">
				<readonly />
				<anchored to="combattitle" width="40" height="30">
					<top anchor="bottom" relation="relative" offset="15" />
					<left anchor="center" offset="-10" />
				</anchored>
			</number_charinit>
			<label_charfieldtop>
				<anchored to="initiative" offset="0,15" />
				<static textres="char_label_initiative" />
			</label_charfieldtop>
			
			<number_charspeed name="speed" source="speed.total">
				<readonly />
				<anchored to="initiative" position="righthigh" offset="15,0" width="40" height="30" />
			</number_charspeed>
			<label_charfieldtop>
				<anchored to="speed" offset="0,15" />
				<static textres="char_label_speed" />
			</label_charfieldtop>

			<string_labeled name="speedspecial" source="speed.special">
				<readonly />
				<anchored to="combattitle">
					<top anchor="bottom" relation="relative" offset="5" />
					<left offset="-5" />
					<right offset="5" />
				</anchored>
				<labelres>char_label_speedspecial</labelres>
				<multilinespacing>20</multilinespacing>
			</string_labeled>
			<string_labeled name="specialdef" source="defenses.special">
				<anchored to="combattitle">
					<top anchor="bottom" relation="relative" offset="5" />
					<left offset="-5" />
					<right offset="5" />
				</anchored>
				<labelres>char_label_specialdef</labelres>
				<multilinespacing>20</multilinespacing>
			</string_labeled>

        <!-- Health/Wounds -->
 			<label_charframetop name="healthtitle">
				<anchored to="combattitle" position="right" offset="25,0" width="180"/>
				<icons>char_stats</icons>
			</label_charframetop>
			
			<number_charwounds name="wounds" source="hp.wounds">
				<anchored to="healthtitle" width="40" height="30">
					<top anchor="bottom" offset="15" />
					<left anchor="center" offset="-60" />
				</anchored>
				<font>reference-b-large</font>
				<description textres="char_tooltip_wounds" />
			</number_charwounds>
			<label_charfieldtop>
				<anchored to="wounds" offset="0,15" />
				<static textres="char_label_wounds" />
			</label_charfieldtop>
			
			<number_dropadd name="hp" source="hp.total">
				<anchored to="wounds" position="righthigh" offset="15,0" width="40" height="30" />
				<font>reference-b-large</font>
				<description textres="hp" />
				<min value="0" />
				<script>
					function onValueChanged()
						window.onHealthChanged();
					end
				</script>
			</number_dropadd>
			<label_charfieldtop>
				<anchored to="hp" offset="5,15" />
				<static textres="char_label_hpmax" />
			</label_charfieldtop>
			
			<basicnumber name="temphp" source="hp.temporary">
				<anchored to="hp" position="righthigh" offset="15,0" width="40" height="30" />
				<font>reference-b-large</font>
				<color>0000AA</color>
				<description textres="temphp" />
				<hideonvalue>0</hideonvalue>
				<script>
					function onDrop(x, y, draginfo)
						if draginfo.getType() == "number" then
							if draginfo.getNumberData() &gt; 0 then
								setValue(draginfo.getNumberData());
							else
								setValue(getValue() + draginfo.getNumberData());
							end
						end
						
						return true;
					end
				</script>
			</basicnumber>
			<label_charfieldtop>
				<anchored to="temphp" offset="0,15" />
				<static textres="char_label_hptemp" />
			</label_charfieldtop>
			<label>
				<anchored to="wounds" position="lefthigh" offset="15,5" />
				<static textres="hp" />
			</label>
			
		</sheetdata>
	</windowclass>

	<windowclass name="charsheet_classes">
		<frame>charsheethelper</frame>
		<placement>
			<size width="470" height="300" />
		</placement>
		<sizelimits>
			<minimum width="470" height="300" />
			<dynamic />
		</sizelimits>
		<nodelete />
		<playercontrol />
		<script>
			function onDrop(x, y, draginfo)
				if draginfo.isType("shortcut") then
					local sClass, sRecord = draginfo.getShortcutData();

					if StringManager.contains({"reference_class", "reference_race", "reference_subrace", "reference_background"}, sClass) then
						CharManager.addInfoDB(getDatabaseNode(), sClass, sRecord);
						return true;
					end
				end
			end
		</script>
		<sheetdata>
			<windowtitlebar_char name="title">
				<prefix>char_classes_title</prefix>
			</windowtitlebar_char>
			<anchor_title_charsheethelper name="contentanchor" />

			<label_charframetop name="leveltitle">
				<anchored to="contentanchor" position="belowleft" offset="10,5" height="20" width="80" />
				<static textres="char_label_totallevel" />
			</label_charframetop>
			<number_charlevel name="level">
				<anchored to="leveltitle" height="20" width="30">
					<top anchor="bottom" offset="10" />
					<left anchor="center" offset="-15" />
				</anchored>
				<frame name="fieldlight" offset="7,5,7,5" />
			</number_charlevel>

			<label_charframetop name="exptitle">
				<anchored to="contentanchor" position="belowleft" offset="110,5" height="20">
					<right offset="-10" />
				</anchored>
			</label_charframetop>
			<number_dropadd name="exp">
				<anchored to="exptitle" height="20" width="70">
					<top anchor="bottom" offset="10" />
					<right anchor="center" offset="-15" />
				</anchored>
				<description textres="char_tooltip_xp" />
			</number_dropadd>
			<label_charfieldtop>
				<anchored to="exp" offset="0,10" />
				<static textres="xp" />
			</label_charfieldtop>
			<basicnumber name="expneeded">
				<anchored to="exptitle" height="20" width="70">
					<top anchor="bottom" offset="10" />
					<left anchor="center" offset="15" />
				</anchored>
				<description textres="char_tooltip_xpneeded" />
				<script>
					function onHover(oncontrol)
						if oncontrol then
							local draginfo = Input.getDragData();
							if draginfo and draginfo.isType("number") and draginfo.getNumberData() &lt; getValue() then
								setColor("BB0000");
							end
						else
							setColor(nil);
						end
					end
					
					function onDrop(x, y, draginfo)
						if draginfo.isType("number") and draginfo.getNumberData() &gt; getValue() then
							setValue(draginfo.getNumberData());
						end

						return true;
					end
				</script>
			</basicnumber>
			<label_charfieldtop>
				<anchored to="expneeded" offset="0,10" />
				<static textres="char_label_nextlevel" />
			</label_charfieldtop>
			
			<label_charframetop name="hdusedtitle">
				<anchored to="contentanchor" position="belowright" offset="45,65" height="20" width="30" />
				<static textres="char_label_hdused" />
			</label_charframetop>
			<label_charframetop name="hdtitle">
				<anchored to="hdusedtitle" position="left" offset="20,0" width="50" />
				<static textres="char_label_hd" />
			</label_charframetop>
			<label_charframetop name="casterlevelmulttitle">
				<anchored to="hdtitle" position="left" offset="20,0" width="50" />
				<static textres="char_label_caster" />
				<tooltip textres="char_tooltip_caster" />
			</label_charframetop>
			<label_charframetop name="classleveltitle">
				<anchored to="casterlevelmulttitle" position="left" offset="20,0" width="35" />
				<static textres="char_label_level" />
			</label_charframetop>
			<label_charframetop name="classtitle">
				<anchored to="classleveltitle" position="left" offset="20,0">
					<left parent="contentanchor" offset="10" />
				</anchored>
				<static textres="char_label_class" />
			</label_charframetop>
			<button_iadd name="classes_iadd">
				<anchored to="hdusedtitle">
					<top anchor="bottom" relation="relative" offset="3" />
					<left anchor="right" offset="15" />
				</anchored>
				<target>classes</target>
			</button_iadd>
			<list_text name="classes">
				<anchored to="contentanchor">
					<top parent="hdusedtitle" anchor="bottom" relation="relative" offset="3" />
					<left offset="5" />
					<right offset="-10" />
					<bottom parent="" offset="-30" />
				</anchored>
				<datasource>.classes</datasource>
				<class>charsheet_class</class>
			</list_text>
			<scrollbar>
				<anchored to="classes" />
				<target>classes</target>
			</scrollbar>
			<button_iedit name="classes_iedit">
				<anchored to="hdusedtitle" position="righthigh" offset="15,0" />
				<target>classes</target>
			</button_iedit>

			<close_charsheethelper />
			<resize_charsheethelper />
		</sheetdata>
	</windowclass>

	<windowclass name="charsheet_class">
		<margins control="0,0,0,2" />
		<sizelimits>	
		 	<minimum height="20" />	
		</sizelimits>
		<script>
			function action(draginfo)
				local nodeChar = getDatabaseNode().getChild("...")
				local rActor = ActorManager.getActor("pc", nodeChar);

				ActionRecovery.performRoll(draginfo, rActor, getDatabaseNode());
			end
			
			function onDragStart(button, x, y, draginfo)
				action(draginfo);
				return true;
			end
			
			function onDoubleClick(x, y)
				action();
				return true;
			end
		</script>
		<sheetdata>
			<genericcontrol name="rightanchor">
				<anchored position="insidetopright" offset="0,3" width="0" height="0" />
				<invisible />
			</genericcontrol>
			<genericcontrol name="spacer">
				<anchored to="rightanchor" width="20" height="20">
					<top />
					<right anchor="left" relation="relative" />
				</anchored>
				<disabled />
			</genericcontrol>
			<linkfield name="shortcut">
				<anchored to="rightanchor" width="20" height="20">
					<top />
					<right anchor="left" />
				</anchored>
				<script>
					function onInit()
						onValueChanged();
					end
					function onValueChanged()
						setVisible(not isEmpty());
					end
				</script>
			</linkfield>
			<button_idelete name="idelete">
				<anchored to="rightanchor">
					<top />
					<right anchor="left" />
				</anchored>
			</button_idelete>
			<number_charwounds name="hdused">
				<anchored to="spacer" position="left" offset="15,0" width="30" />
				<description textres="char_tooltip_hdused" />
			</number_charwounds>
			<basicdice name="hddie">
				<anchored to="hdused" position="left" offset="20,0" width="50" />
				<script>
					function onDragStart(button, x, y, draginfo)
						return window.onDragStart(button, x, y, draginfo);
					end

					function onDoubleClick(x, y)
						return window.onDoubleClick(x, y);
					end
				</script>
			</basicdice>
			<button_checkbox name="casterpactmagic">
				<anchored to="hddie" position="left" offset="15,0" width="10" />
				<tooltip textres="char_tooltip_casterpactmagic" />
			</button_checkbox>
			<buttonfield name="casterlevelinvmult">
				<anchored to="casterpactmagic" position="left" offset="5,0" width="40" />
				<frame name="fielddark" offset="7,5,7,5" />
				<state text="-" />
				<state text="1 x" />
				<state text="1/2 x" />
				<state text="1/3 x" />
			</buttonfield>
			<basicnumber name="level">
				<anchored to="casterlevelinvmult" position="left" offset="20,0" width="30" />
			</basicnumber>
			<string_textlistitem name="name">
				<anchored>
					<top parent="rightanchor" offset="0" />
					<left offset="5" />
					<right parent="level" anchor="left" relation="relative" offset="-25" />
				</anchored>
				<multilinespacing>20</multilinespacing>
			</string_textlistitem>
		</sheetdata>
	</windowclass>	

	<windowclass name="charsheet_combatcalc">
		<frame>charsheethelper</frame>
		<placement>
			<size width="500" height="220" />
		</placement>
		<nodelete />
		<playercontrol />
		<sheetdata>
			<windowtitlebar_char name="title">
				<prefix>char_combatcalc_title</prefix>
			</windowtitlebar_char>
			<anchor_title_charsheethelper name="contentanchor" />

			<anchor_column name="columnanchor">
				<anchored to="contentanchor" position="below" offset="0,-5" />
			</anchor_column>
			
			<!-- Init Detail -->
			<label name="label_initdetail">
				<anchored width="60">
					<top parent="columnanchor" anchor="bottom" relation="relative" offset="20" />
					<left offset="30" />
				</anchored>
				<static textres="char_label_initdetail" />
			</label>
			<basicnumber name="initmiscbonus" source="initiative.misc">
				<anchored to="label_initdetail" position="right" offset="5,0" width="45" />
				<hideonvalue>0</hideonvalue>
			</basicnumber>
			<label_fieldtop name="label_initmiscbonus">
				<anchored to="initmiscbonus" />
				<static textres="char_label_adj" />
			</label_fieldtop>
			
			<!-- Speed Detail -->
			<label name="label_speeddetail">
				<anchored width="60">
					<top parent="columnanchor" anchor="bottom" relation="relative" offset="20" />
					<left offset="30" />
				</anchored>
				<static textres="char_label_speeddetail" />
			</label>
			<basicnumber name="speedbase" source="speed.base">
				<anchored to="label_speeddetail" position="righthigh" offset="5,0" width="45" height="20" />
			</basicnumber>
			<label_fieldtop name="label_speedbase">
				<anchored to="speedbase" />
				<static textres="char_label_speedbase" />
			</label_fieldtop>
			
			<!-- Armor Detail -->
			<label name="label_armordetail">
				<anchored width="60">
					<top parent="columnanchor" anchor="bottom" relation="relative" offset="20" />
					<left offset="30" />
				</anchored>
				<static textres="char_label_armordetail" />
			</label>
			<basicnumber name="acbase" source="defenses.ac.base">
				<default>10</default>
				<anchored to="label_armordetail" position="righthigh" offset="5,0" width="45" height="20" />
			</basicnumber>
			<label_fieldtop name="label_acbase">
				<anchored to="acbase" />
				<static textres="char_label_armorbase" />
			</label_fieldtop>
			<label name="label_armorplus">
				<anchored to="acbase" position="righthigh" offset="5,0" width="10" />
				<static>+</static>
				<center />
			</label>
			<basicnumber name="acarmor" source="defenses.ac.armor">
				<anchored to="label_armorplus" position="righthigh" offset="5,0" width="45" height="20" />
			</basicnumber>
			<label_fieldtop name="label_acarmor">
				<anchored to="acarmor" />
				<static textres="char_label_armormain" />
			</label_fieldtop>
			<label name="label_armorplus2">
				<anchored to="acarmor" position="righthigh" offset="5,0" width="10" />
				<static>+</static>
				<center />
			</label>
			<basicnumber name="acshield" source="defenses.ac.shield">
				<anchored to="label_armorplus2" position="righthigh" offset="5,0" width="45" height="20" />
			</basicnumber>
			<label_fieldtop name="label_acshield">
				<anchored to="acshield" />
				<static textres="char_label_armorshield" />
			</label_fieldtop>
			<label name="label_armorplus3">
				<anchored to="acshield" position="righthigh" offset="5,0" width="10" />
				<static>+</static>
				<center />
			</label>
			<label name="label_armorplus5">
				<anchored to="acshield" position="righthigh" offset="5,0" width="10" />
				<static>+</static>
				<center />
			</label>
			<basicnumber name="acmisc" source="defenses.ac.misc">
				<anchored to="label_armorplus5" position="righthigh" offset="5,0" width="45" height="20" />
			</basicnumber>
			<label_fieldtop name="label_acmisc">
				<anchored to="acmisc" />
				<static textres="char_label_armormisc" />
			</label_fieldtop>

			<close_charsheethelper />
		</sheetdata>
	</windowclass>
	
	<windowclass name="charsheet_healthcalc">
		<frame>charsheethelper</frame>
		<placement>
			<size width="400" height="120" />
		</placement>
		<nodelete />
		<playercontrol />
		<sheetdata>
			<windowtitlebar_char name="title">
				<prefix>char_healthcalc_title</prefix>
			</windowtitlebar_char>
			<anchor_title_charsheethelper name="contentanchor" />

			<anchor_column name="columnanchor">
				<anchored to="contentanchor" position="below" offset="0,-5" />
			</anchor_column>
			
			<!-- Hit Dice Detail -->
			<label name="label_hddetail">
				<anchored width="80">
					<top parent="columnanchor" anchor="bottom" relation="relative" offset="20" />
					<left offset="30" />
				</anchored>
				<static textres="char_label_hddetail" />
			</label>
			<label name="label_hddummy">
				<anchored to="label_hddetail" position="righthigh" offset="5,0" width="45" height="20" />
				<static textres="char_label_hdclass" />
				<center />
			</label>
			<label name="label_hdplus">
				<anchored to="label_hddummy" position="righthigh" offset="5,0" width="10" />
				<static>+</static>
				<center />
			</label>
			<cycler_abilitybase name="hdstat">
				<anchored to="label_hdplus" position="righthigh" offset="5,0" width="45" height="20" />
				<source><name>hp.hdstat</name></source>
			</cycler_abilitybase>
			<label_fieldtop name="label_hdstat">
				<anchored to="hdstat" />
				<static textres="char_label_hdstat" />
			</label_fieldtop>
			<label name="label_hdplus2">
				<anchored to="hdstat" position="righthigh" offset="5,0" width="10" />
				<static>+</static>
				<center />
			</label>
			<cycler_ability name="hdstat2">
				<anchored to="label_hdplus2" position="righthigh" offset="5,0" width="45" height="20" />
				<source><name>hp.hdstat2</name></source>
			</cycler_ability>
			<label_fieldtop name="label_hdstat2">
				<anchored to="hdstat2" />
				<static textres="2nd" />
			</label_fieldtop>
			<label name="label_hdplus3">
				<anchored to="hdstat2" position="righthigh" offset="5,0" width="10" />
				<static>+</static>
				<center />
			</label>
			<basicnumber name="hdmod" source="hp.hdmod">
				<anchored to="label_hdplus3" position="righthigh" offset="5,0" width="45" height="20" />
				<hideonvalue value="0" />
			</basicnumber>
			<label_fieldtop name="label_hdmod">
				<anchored to="hdmod" />
				<static textres="char_label_hdmisc" />
			</label_fieldtop>

			<close_charsheethelper />
		</sheetdata>
	</windowclass>
</root>
